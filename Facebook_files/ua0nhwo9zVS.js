if (self.CavalryLogger) { CavalryLogger.start_js(["zhmmZ"]); }

__d("MWChatMultitabCalc.bs",["gkx","bs_js_math","qex","bs_caml_int32","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";function a(a){a=b("qex")._("1489057");if(a||window.innerWidth<1100)return 1;else{a=b("bs_caml_option").nullable_to_opt(b("qex")._("1418540"))==="blue_tabs";var c=a?b("bs_caml_option").nullable_to_opt(b("qex")._("1532881")):"fifty_plus_one",d=window.location.pathname==="/"||window.location.pathname==="/home.php";d=d&&!b("gkx")("1594186")?10:310;a=a?d:90;d=b("qex")._("1586109")?306:338;if(c!==void 0)switch(c){case"fifty_plus_one":c=((window.innerWidth/2|0)-a|0)/d;if(c<1)return 1;else return b("bs_js_math").ceil_int(c);case"no_limits":c=(window.innerWidth-a|0)/d;if(c<1)return 1;else return b("bs_js_math").floor_int(c);case"no_limits_before_lhc":c=window.innerWidth-320|0;c=(c-a|0)/d;if(c<1)return 1;else return b("bs_js_math").floor_int(c);default:}c=b("bs_caml_int32").div((window.innerWidth/2|0)-a|0,d|0);if(c<1)return 1;else return c}}f.calculateMaxOpenTabs=a}),null);
__d("MWChatMultitabReducer.bs",["bs_block","qex","bs_caml_obj","bs_caml_array","setTimeout","bs_caml_option","MWChatCrushState.bs","MWChatMultitabCalc.bs","MessengerWebEntryPoint","MWChatMultitabDispatcher.bs","MWChatLogAndStoreEntrypoint.bs","MWChatComposerViewStateStore.bs"],(function(a,b,c,d,e,f){"use strict";var g={contents:b("MWChatMultitabCalc.bs").calculateMaxOpenTabs(0)};function h(a){return{threadID:a,isTabFocused:!0,isSearchView:!1,hasContent:{contents:!1},isCollapsed:!1,searchInitialParticipant:void 0}}function i(a,c){return a.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,c)})===4}function j(a,c){if(c.length<5)return!1;else{var d=b("bs_caml_array").caml_array_get(c,4);return a.some(function(a){return b("bs_caml_obj").caml_equal(a.threadID,[d])})}}var k=b("bs_caml_option").nullable_to_opt(b("qex")._("1418540"))==="blue_tabs",l=b("qex")._("1489057"),m=b("qex")._("1512507");function n(a,c,d){var e,f=(e=b("bs_caml_array")).caml_array_get(a,c);e.caml_array_set(a,c,e.caml_array_get(a,d));e.caml_array_set(a,d,f);return a}function o(a,c,d){var e=a.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,d)});if(e!==-1)if(e>=5)if(c.some(function(b){b=b.threadID;return b?i(a,b[0]):!1}))return n([d].concat(a.filter(function(a){return b("bs_caml_obj").caml_notequal(a,d)})),4,5);else return[d].concat(a.filter(function(a){return b("bs_caml_obj").caml_notequal(a,d)}));else return a;else if(j(c,a))return n([d].concat(a),4,5);else return[d].concat(a)}function p(a,c,d){var e=a.findIndex(function(a){return b("bs_caml_obj").caml_equal(a[0],c)});if(e!==-1)return a.slice(e+1|0,a.length).concat(a.slice(0,e),[[c,b("setTimeout")(function(a){return b("MWChatMultitabDispatcher.bs").dispatch(void 0,d,b("bs_block").__(9,[c]))},3e3)]]);else return[[c,b("setTimeout")(function(a){return b("MWChatMultitabDispatcher.bs").dispatch(void 0,d,b("bs_block").__(9,[c]))},3e3)]].concat(a)}function q(a){g.contents=b("MWChatMultitabCalc.bs").calculateMaxOpenTabs(0);var c=a.openTabsState;if(c.length>g.contents){var d=c.findIndex(function(a){return a.isTabFocused});c=c.reduceRight(function(a,b,c){var e=d===-1?g.contents-a.length|0:(g.contents-a.length|0)-1|0;if(c===d||e>0)return[b].concat(a);else return a},[]);return{openTabsState:c,chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers}}else return a}function r(a,c){var d=a.findIndex(function(a){return b("bs_caml_obj").caml_equal(a.threadID,c.threadID)});if(d===-1)return[c].concat(a).slice(0,g.contents);else{a=a.slice();b("bs_caml_array").caml_array_set(a,d,c);return a}}function s(a,c,d){a=a.slice();a.splice(d,1);d=a.findIndex(function(a){return b("bs_caml_obj").caml_equal(a.threadID,c.threadID)});if(d===-1)return[c].concat(a).slice(0,g.contents);else return a}function t(a,b,c){c=c!==void 0?!c.preventAutofocus:!0;var d=a.openTabsState,e=d.filter(function(a){a=a.threadID;if(a)return!0;else return!1}),f=h([b]);return{openTabsState:r(e,{threadID:f.threadID,isTabFocused:c,isSearchView:f.isSearchView,hasContent:f.hasContent,isCollapsed:f.isCollapsed,searchInitialParticipant:f.searchInitialParticipant}),chatHeads:o(a.chatHeads,d,b),forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers}}function u(a,b){var c={contents:!1};return{openTabsState:r(a.openTabsState,{threadID:0,isTabFocused:!0,isSearchView:!1,hasContent:c,isCollapsed:!1,searchInitialParticipant:b}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers}}function v(a){var b={contents:!1};return{openTabsState:r(a.openTabsState,{threadID:0,isTabFocused:!0,isSearchView:!0,hasContent:b,isCollapsed:!1,searchInitialParticipant:void 0}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers}}function w(a,c,d){var e=a.notificationTimers,f=a.forceCollapsedHeads,i=a.chatHeads,j=a.openTabsState;i.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,c)})===-1&&b("MWChatLogAndStoreEntrypoint.bs").log(c,b("MessengerWebEntryPoint").MESSAGE_RECEIVED);if(j.length===0&&i.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,c)})===-1){var l=h([c]);return{openTabsState:[{threadID:l.threadID,isTabFocused:!1,isSearchView:l.isSearchView,hasContent:l.hasContent,isCollapsed:l.isCollapsed,searchInitialParticipant:l.searchInitialParticipant}],chatHeads:o(i,j,c),forceCollapsedHeads:f,notificationTimers:p(e,c,d)}}if(k&&g.contents===1){l=j.every(function(a){if(!a.isTabFocused||a.isCollapsed)return!a.hasContent.contents;else return!1});var m=p(e,c,d);if(l){l=h([c]);return{openTabsState:r(j,{threadID:l.threadID,isTabFocused:!1,isSearchView:l.isSearchView,hasContent:l.hasContent,isCollapsed:l.isCollapsed,searchInitialParticipant:l.searchInitialParticipant}),chatHeads:o(i,j,c),forceCollapsedHeads:f,notificationTimers:m}}else return{openTabsState:a.openTabsState,chatHeads:o(i,j,c),forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:m}}else if(g.contents>1){l=j.length;m=i.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,c)})===-1;l=m&&l<g.contents;m=!j.every(function(a){return a.hasContent.contents})&&m;var n=j.findIndex(function(a){return a.isCollapsed});n===-1&&(n=j.findIndex(function(a){if(a.isTabFocused)return!1;else return!a.hasContent.contents}));n===-1&&(n=j.findIndex(function(a){return!a.isTabFocused}));if(l){l=h([c]);return{openTabsState:r(j,{threadID:l.threadID,isTabFocused:!1,isSearchView:l.isSearchView,hasContent:l.hasContent,isCollapsed:l.isCollapsed,searchInitialParticipant:l.searchInitialParticipant}),chatHeads:o(i,j,c),forceCollapsedHeads:f,notificationTimers:p(e,c,d)}}else if(m){l=h([c]);return{openTabsState:s(j,{threadID:l.threadID,isTabFocused:!1,isSearchView:l.isSearchView,hasContent:l.hasContent,isCollapsed:l.isCollapsed,searchInitialParticipant:l.searchInitialParticipant},n),chatHeads:o(i,j,c),forceCollapsedHeads:f,notificationTimers:p(e,c,d)}}else return{openTabsState:a.openTabsState,chatHeads:o(i,j,c),forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:p(e,c,d)}}else if(j.every(function(a){if(a.isTabFocused)return!1;else return!a.hasContent.contents})&&i.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,c)})===-1){m=h([c]);return{openTabsState:r(j,{threadID:m.threadID,isTabFocused:!1,isSearchView:m.isSearchView,hasContent:m.hasContent,isCollapsed:m.isCollapsed,searchInitialParticipant:m.searchInitialParticipant}),chatHeads:o(i,j,c),forceCollapsedHeads:f,notificationTimers:p(e,c,d)}}else return{openTabsState:a.openTabsState,chatHeads:o(i,j,c),forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:p(e,c,d)}}function x(a,b){return{openTabsState:a.openTabsState,chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers.filter(function(a){return a[0]!==b})}}function y(a,c,d){var e=c.length;if(e<g.contents&&d.length>e){e=d.find(function(a){return c.every(function(c){c=c.threadID;if(c)return b("bs_caml_obj").caml_notequal(c[0],a);else return!0})});if(e!==void 0){e=h([e]);return{openTabsState:r(c,{threadID:e.threadID,isTabFocused:e.isTabFocused,isSearchView:e.isSearchView,hasContent:e.hasContent,isCollapsed:!0,searchInitialParticipant:e.searchInitialParticipant}),chatHeads:d,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers}}else return a}else return a}function z(a,c){var d=a.chatHeads;if(d.length!==0){var e=d.findIndex(function(a){return b("bs_caml_obj").caml_equal(a,c)});if(e!==-1){b("MWChatComposerViewStateStore.bs").set(c,void 0);d=d.slice(0,e).concat(d.slice(e+1|0));if(d.length!==0){e=a.openTabsState.filter(function(a){a=a.threadID;if(a)return b("bs_caml_obj").caml_notequal(a[0],c);else return!0});var f=a.forceCollapsedHeads,g=a.notificationTimers;f={openTabsState:e,chatHeads:d,forceCollapsedHeads:f,notificationTimers:g};if(k)return y(f,e,d);else return f}else return b("MWChatCrushState.bs").none}else return a}else return b("MWChatCrushState.bs").none}function a(a){return b("MWChatCrushState.bs").none}function A(a){var c=a.chatHeads;if(c.length!==0){var d=a.openTabsState.filter(function(a){a=a.threadID;if(a)return!0;else return!1}),e=a.forceCollapsedHeads;a=a.notificationTimers;e={openTabsState:d,chatHeads:c,forceCollapsedHeads:e,notificationTimers:a};if(k)return y(e,d,c);else return e}else return b("MWChatCrushState.bs").none}function B(a,c){if(k)return{openTabsState:a.openTabsState.map(function(a){var d=a.threadID;if(d&&!b("bs_caml_obj").caml_equal(d[0],c))return a;else return{threadID:a.threadID,isTabFocused:a.isTabFocused,isSearchView:a.isSearchView,hasContent:a.hasContent,isCollapsed:!0,searchInitialParticipant:a.searchInitialParticipant}}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers};else{var d=a.chatHeads,e=a.openTabsState.filter(function(a){a=a.threadID;if(a)return b("bs_caml_obj").caml_notequal(a[0],c);else return!0});d=l||m?d:o(d.filter(function(a){return b("bs_caml_obj").caml_notequal(a,c)}),e,c);return{openTabsState:e,chatHeads:d,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers}}}function C(a,c){var d=a.openTabsState,e=d.find(function(a){a=a.threadID;if(a)return b("bs_caml_obj").caml_equal(a[0],c);else return!1});if(e!==void 0)return{openTabsState:r(d,{threadID:e.threadID,isTabFocused:!0,isSearchView:e.isSearchView,hasContent:e.hasContent,isCollapsed:e.isCollapsed,searchInitialParticipant:e.searchInitialParticipant}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers};else return a}function D(a){var b=a.openTabsState,c=b.find(function(a){a=a.threadID;if(a)return!1;else return!0});if(c!==void 0)return{openTabsState:r(b,{threadID:c.threadID,isTabFocused:!0,isSearchView:c.isSearchView,hasContent:c.hasContent,isCollapsed:c.isCollapsed,searchInitialParticipant:c.searchInitialParticipant}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers};else return a}function E(a,c){var d=a.openTabsState,e=d.find(function(a){a=a.threadID;if(a)return b("bs_caml_obj").caml_equal(a[0],c);else return!1});if(e!==void 0)return{openTabsState:r(d,{threadID:e.threadID,isTabFocused:!1,isSearchView:e.isSearchView,hasContent:e.hasContent,isCollapsed:e.isCollapsed,searchInitialParticipant:e.searchInitialParticipant}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers};else return a}function F(a){var b=a.openTabsState,c=b.find(function(a){a=a.threadID;if(a)return!1;else return!0});if(c!==void 0)return{openTabsState:r(b,{threadID:c.threadID,isTabFocused:!1,isSearchView:c.isSearchView,hasContent:c.hasContent,isCollapsed:c.isCollapsed,searchInitialParticipant:c.searchInitialParticipant}),chatHeads:a.chatHeads,forceCollapsedHeads:a.forceCollapsedHeads,notificationTimers:a.notificationTimers};else return a}function c(a){return a}function G(a,b){g.contents=1;if(b){b=a.chatHeads;var c=[];a.openTabsState.forEach(function(a){a=a.threadID;if(a){c.push(a[0]);return 0}else return 0});var d=b.filter(function(a){return!c.includes(a)});b=l||m?b:c.concat(d);return{openTabsState:[],chatHeads:b,forceCollapsedHeads:c,notificationTimers:a.notificationTimers}}else return a}function H(a,c){g.contents=b("MWChatMultitabCalc.bs").calculateMaxOpenTabs(0);if(c){c=a.openTabsState;c=c.length!==0?c:a.forceCollapsedHeads.map(function(a){return h([a])});return{openTabsState:c,chatHeads:a.chatHeads,forceCollapsedHeads:[],notificationTimers:a.notificationTimers}}else return a}function d(a,c,d){if(typeof c==="number")switch(c){case 0:return v(a);case 1:return b("MWChatCrushState.bs").none;case 2:return a;case 3:return A(a);case 4:return F(a);case 5:return D(a);case 6:return q(a)}else switch(c.tag|0){case 0:return u(a,c[0]);case 1:return t(a,c[0],c[1]);case 2:return w(a,c[0],d);case 3:return z(a,c[0]);case 4:return B(a,c[0]);case 5:return G(a,c[0]);case 6:return H(a,c[0]);case 7:return E(a,c[0]);case 8:return C(a,c[0]);case 9:return x(a,c[0])}}e=5;var I=3e3;f.maxOpenTabs=g;f.maxChatHeads=e;f.notificationTime=I;f.getDefaultOpenTab=h;f.isLastActive=i;f.isLastActiveChatHeadAnOpenTab=j;f.isBlueTab=k;f.isForcedSingleTab=l;f.showTabIndicators=m;f.swap=n;f.reorderChatHeads=o;f.updateNotificationTimers=p;f.recalculateOpenTabs=q;f.addOrUpdateTab=r;f.addTabAndRemoveSpecificTab=s;f.openTab=t;f.openNewTab=u;f.openNewSearchTab=v;f.openTabFromNewMessage=w;f.closeNotification=x;f.appendOpenTabIfPossible=y;f.closeTab=z;f.closeTabs=a;f.closeNewTab=A;f.collapseTab=B;f.focusTab=C;f.focusNewTab=D;f.blurTab=E;f.blurNewTab=F;f.collapseTabs=c;f.forceCollapseTabs=G;f.undoForceCollapseTabs=H;f.reducer=d}),null);
__d("MWChatMultitabCookieReader.bs",["bs_curry","gkx","MWCount.bs","qex","bs_caml_option","killswitch","MWChatThreadId.bs","MWChatCrushState.bs","MessengerWebEvent","MWChatMultitabReducer.bs","MessengerWebEntryPoint","MWChatLogAndStoreEntrypoint.bs","MessengerWebPresenceCookieData","MessengerWebStgTypedLoggerLite.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){a=b("killswitch")("MESSENGER_WEB_STOP_PERSISTING_CHAT_HEADS");if(a){b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Show.none,0);b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0);return b("MWChatCrushState.bs").none}else{a=b("MessengerWebPresenceCookieData").cookie;if(a==null){b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Show.none,0);b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0);return b("MWChatCrushState.bs").none}else{var c=b("bs_caml_option").nullable_to_opt(b("qex")._("1418540"))==="blue_tabs",d=b("qex")._("1489057");d=d||b("gkx")("1578502");var e=a.slice(0,1);a=a.slice(1);if(e==="C"){e=JSON.parse(a);a=e.t3.reduce(function(a,c){c=b("MWChatThreadId.bs").deserializeFuture(c.i);c!==void 0&&a.push(c);return a},[]);if(a.length!==0){a.forEach(function(a){return b("MWChatLogAndStoreEntrypoint.bs").log(a,b("MessengerWebEntryPoint").COOKIE)});b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").LOAD_TAB_FROM_COOKIE,extra_data:{tabNumber:a.length}});b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Show.some,0);if(c)b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0),c=a.slice(0,b("MWChatMultitabReducer.bs").maxOpenTabs.contents).map(function(a){a=b("MWChatMultitabReducer.bs").getDefaultOpenTab([a]);return{threadID:a.threadID,isTabFocused:a.isTabFocused,isSearchView:a.isSearchView,hasContent:a.hasContent,isCollapsed:!0,searchInitialParticipant:a.searchInitialParticipant}});else if(d){d=e.lm3;if(d!==void 0){e=b("MWChatThreadId.bs").deserializeFuture(b("bs_caml_option").valFromOption(d));if(e!==void 0){b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.one,0);d=b("MWChatMultitabReducer.bs").getDefaultOpenTab([e]);c=[{threadID:d.threadID,isTabFocused:!1,isSearchView:d.isSearchView,hasContent:d.hasContent,isCollapsed:d.isCollapsed,searchInitialParticipant:d.searchInitialParticipant}]}else b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0),c=[]}else b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0),c=[]}else b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0),c=[];return{openTabsState:c,chatHeads:a,forceCollapsedHeads:[],notificationTimers:[]}}else{b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Show.none,0);b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0);return b("MWChatCrushState.bs").none}}else{b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Show.none,0);b("bs_curry")._1(b("MWCount.bs").Comet.Cookie.Lift.none,0);return b("MWChatCrushState.bs").none}}}}f.read=a}),null);
__d("MWChatMultitabProvider.bs",["React","MWCount.bs","MWChatCrushState.bs","MWChatMultitabContext.bs","MWChatMultitabReducer.bs","MWChatMultitabDispatcher.bs","MWChatMultitabCookieReader.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h={contents:void 0};function i(a){b("MWCount.bs").Comet.load(0);a=b("MWChatMultitabDispatcher.bs").make(b("MWChatMultitabReducer.bs").reducer,b("MWChatMultitabCookieReader.bs").read(0));h.contents=a;return h.contents}function a(a){a=h.contents;if(a!==void 0)return a.state;else return b("MWChatCrushState.bs").none}function c(a){a=a.children;var c=h.contents;c=c!==void 0?c:i(0);return g.createElement(b("MWChatMultitabContext.bs").context.Provider,{value:c,children:a})}d=c;f.environment=h;f.createEnvironment=i;f.getStateSnapshot=a;f.make=d}),null);
__d("MWChatMultitabProvider.re",["MWChatMultitabProvider.bs"],(function(a,b,c,d,e,f){a=b("MWChatMultitabProvider.bs").getStateSnapshot;f.getStateSnapshot=a;(function(a){return null});c=b("MWChatMultitabProvider.bs").make;f.make=c}),null);
__d("MWChatBlueTabsProvider.react",["MWChatMultitabProvider.re"],(function(a,b,c,d,e,f){"use strict";e.exports=b("MWChatMultitabProvider.re").make}),null);
__d("MWChatMultiTabProvider.react",["MWChatMultitabProvider.re"],(function(a,b,c,d,e,f){"use strict";e.exports=b("MWChatMultitabProvider.re").make}),null);